# –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä COVID –ø–æ —Ä–µ–Ω—Ç–≥–µ–Ω–æ–≤—Å–∫–∏–º —Å–Ω–∏–º–∫–∞–º –ª—ë–≥–∫–∏—Ö ü´Å

## ‚ö†Ô∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ Python

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Python –≤–µ—Ä—Å–∏–∏ 3.10 –∏–ª–∏ –Ω–∏–∂–µ**.  
TensorFlow –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å –±–æ–ª–µ–µ –Ω–æ–≤—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏ (3.11+).

## üîó –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö

–°—Ç–∞—Ç—å—è: [https://pmc.ncbi.nlm.nih.gov/articles/PMC7372265/](https://pmc.ncbi.nlm.nih.gov/articles/PMC7372265/)  
–î–∞—Ç–∞—Å–µ—Ç: [https://github.com/PovilasVelicka/Covid.git](https://github.com/PovilasVelicka/Covid.git)

1. –°–∫–∞—á–∞–ª –∞—Ä—Ö–∏–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –∏ `metadata.csv`, –ø–æ–º–µ—Å—Ç–∏–ª –≤—Å—ë –≤ –∫–∞—Ç–∞–ª–æ–≥ `dataset/`
2. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª —Å—Ç—Ä—É–∫—Ç—É—Ä—É: 584 —Å–ª—É—á–∞—è `Pneumonia/Viral/COVID-19` –∏ —Ç–æ–ª—å–∫–æ 22 —Å–ª—É—á–∞—è `No Finding`
3. –ü—Ä–∏–Ω—è–ª —Ä–µ—à–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ —Å–ª—É—á–∞–∏ COVID –∫–∞–∫ `covid`, –æ—Å—Ç–∞–ª—å–Ω—ã–µ (–∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º `todo`, `Unknown`, `CT`) ‚Äî –∫–∞–∫ `non_covid`
4. –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–ª —Ç–æ–ª—å–∫–æ `X-ray` –∏ –ø—Ä–æ–µ–∫—Ü–∏–∏ `PA`, `AP`, –ø—Ä–∏ –Ω–µ—Ö–≤–∞—Ç–∫–µ ‚Äî –¥–æ–±–∞–≤–∏–ª `AP Supine`
5. –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–ª —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç —Å –¥–≤—É–º—è –∫–ª–∞—Å—Å–∞–º–∏: `covid` –∏ `non_covid`
6. –ü—Ä–æ–∏–∑–≤—ë–ª `stratified` —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ `train`, `val`, `test`
7. –°–∫–æ–ø–∏—Ä–æ–≤–∞–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É `dataset/split/{train,val,test}/{covid,non_covid}`

## üß† –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

- –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ `ResNet50` (–ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–∞—è –Ω–∞ ImageNet)
- –ú–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–ª–∞ –æ–¥–∏–Ω –±–∏–Ω–∞—Ä–Ω—ã–π –∫–ª–∞—Å—Å (`sigmoid`)
- –û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–ª–æ—Å—å —Å –ø–æ–º–æ—â—å—é `ImageDataGenerator`
- –ú–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω—è–ª–∞—Å—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ `.h5` –∏ –∑–∞—Ç–µ–º –¥–æ–æ–±—É—á–∞–ª–∞—Å—å

### üõ† –ü—Ä–æ–±–ª–µ–º–∞:

–í –Ω–∞—á–∞–ª–µ –º–æ–¥–µ–ª—å –≤—Å–µ–≥–¥–∞ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–ª–∞ —Ç–æ–ª—å–∫–æ `non_covid`, –∏–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ:
- –º–µ—Ç–∫–∞ `covid` = `0`, `non_covid` = `1`
- –ø—Ä–∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –æ—Ç—á—ë—Ç–∞ –º–µ—Ç–∫–∏ –±—ã–ª–∏ –ø–µ—Ä–µ–ø—É—Ç–∞–Ω—ã

–†–µ—à–µ–Ω–æ: –¥–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `classes = ["non_covid", "covid"]` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤

## üîÅ –û–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è –º–æ–¥–µ–ª—å

–í –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –±—ã–ª–æ –ø—Ä–∏–Ω—è—Ç–æ —Ä–µ—à–µ–Ω–∏–µ **–∑–∞–º–µ–Ω–∏—Ç—å —Ç—è–∂—ë–ª—É—é ResNet50** –Ω–∞ **–±–æ–ª–µ–µ –ª—ë–≥–∫—É—é MobileNetV2** ‚Äî –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –æ–±—É—á–µ–Ω–∏—è –∏ –æ–±–ª–µ–≥—á–µ–Ω–∏—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è.

- MobileNetV2 ‚Äî –∫–æ–º–ø–∞–∫—Ç–Ω–∞—è –∏ –±—ã—Å—Ç—Ä–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, —Ç–∞–∫–∂–µ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–∞—è –Ω–∞ ImageNet
- –ó–∞–º–æ—Ä–æ–∂–µ–Ω—ã –Ω–∏–∂–Ω–∏–µ 2/3 —Å–ª–æ—ë–≤
- –î–æ–±–∞–≤–ª–µ–Ω —Å–ª–æ–π `GlobalAveragePooling`, –æ–¥–∏–Ω —Å–∫—Ä—ã—Ç—ã–π —Å–ª–æ–π –∏ –≤—ã—Ö–æ–¥ `sigmoid`

## ‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è:

- –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤–∫–ª—é—á–∞—é—Ç: –ø–æ–≤–æ—Ä–æ—Ç—ã, —Å–¥–≤–∏–≥–∏, –º–∞—Å—à—Ç–∞–±, —è—Ä–∫–æ—Å—Ç—å –∏ –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `class_weight` –¥–ª—è –±–æ—Ä—å–±—ã —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –∫–ª–∞—Å—Å–æ–≤
- Callbacks: `ModelCheckpoint`, `EarlyStopping`, `ReduceLROnPlateau`
- –û–±—É—á–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ `EarlyStopping`

## üìâ –ö–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –¥–æ –¥–æ–æ–±—É—á–µ–Ω–∏—è (15 —ç–ø–æ—Ö)

- –û–±—â–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å: ~67%
- –ö–ª–∞—Å—Å—ã:

| –ö–ª–∞—Å—Å       | Precision | Recall | F1-score |
|-------------|-----------|--------|----------|
| `covid`     | 0.51      | 0.95   | 0.67     |
| `non_covid` | 0.95      | 0.51   | 0.67     |

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
- –ú–æ–¥–µ–ª—å **–Ω–∞—Ö–æ–¥–∏—Ç –ø–æ—á—Ç–∏ –≤—Å–µ —Å–ª—É—á–∞–∏ COVID** (Recall = 95%)
- –ù–æ —á–∞—Å—Ç–æ –æ—à–∏–±–∞–µ—Ç—Å—è, –≥–æ–≤–æ—Ä—è COVID –≤–º–µ—Å—Ç–æ `non_covid` (–Ω–∏–∑–∫–∏–π precision)

## üîÅ Fine-tuning (–¥–æ–æ–±—É—á–µ–Ω–∏–µ)

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –±—ã–ª–∞ –æ–±—É—á–µ–Ω–∞ –º–æ–¥–µ–ª—å MobileNetV2 –Ω–∞ –±–∞–∑–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –ª–æ–≥–∏–∫–∏:

- –£–º–µ–Ω—å—à–µ–Ω learning rate –¥–æ `1e-5`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –≤–µ—Å–∞ –∫–ª–∞—Å—Å–æ–≤ –∏ callbacks
- –î–æ–æ–±—É—á–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–æ—Å—å –Ω–∞ —Ä–∞–Ω–Ω–µ–π —ç–ø–æ—Ö–µ (EarlyStopping)

### üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ –¥–æ–æ–±—É—á–µ–Ω–∏—è:

```
üîç Classification Report:
              precision    recall  f1-score   support
   non_covid       0.50      0.89      0.64        19
       covid       0.90      0.51      0.65        35

‚úÖ Sensitivity (Recall COVID): 0.895  
‚úÖ Specificity (True Negative Rate non-COVID): 0.514
```

## üß™ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ –µ—Å—Ç—å:
   - `app.py` ‚Äî –º–æ–¥—É–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
   - `covid_classifier_resnet50.keras` –∏–ª–∏ `covid_classifier_mobilenetv2.keras` ‚Äî –æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
   - `class_indices.json` ‚Äî —Å–ª–æ–≤–∞—Ä—å –º–µ—Ç–æ–∫
   - `covid.png` ‚Äî –ø—Ä–∏–º–µ—Ä COVID-—Å–Ω–∏–º–∫–∞
   - `non_covid.png` ‚Äî –ø—Ä–∏–º–µ—Ä –Ω–µ-COVID —Å–Ω–∏–º–∫–∞

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ:

```bash
python app.py covid.png
python app.py non_covid.png
```

3. –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:

```
üîé –†–µ–∑—É–ª—å—Ç–∞—Ç:
  ‚û§ –ö–ª–∞—Å—Å      : covid
  ‚û§ –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: 92.3%
```

## üì¶ –í—ã–≤–æ–¥

- –ü–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª: –æ—Ç –∞–Ω–∞–ª–∏–∑–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ –¥–æ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ `MobileNetV2` –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ö–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ —É–≤–µ–ª–∏—á–µ–Ω–æ –±–ª–∞–≥–æ–¥–∞—Ä—è —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –æ–±—É—á–∞—é—â–µ–π –ª–æ–≥–∏–∫–µ
- –ú–æ–¥–µ–ª—å –ø—Ä–∏–≥–æ–¥–Ω–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
